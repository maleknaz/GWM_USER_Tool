import itertools;import os;import re;import sys

_Y16pccsmJOAVZctSaX5KkAP1sGEAo1 = os.path.dirname(




























                                                             os.path.abspath(




























                                                                 __file__






















                                                                                                                ))
class EP5OANGGpt54bmlGQ71GFPcKCnTo5R(




























                                                             






















                                                                                                                ):

    def __init__(




























                                                                 self






















                                                                                                                    ):
        self._VYtalybfeVgGQ9k2kie7X3aTF14HTw = []
        for _bipEZxWY564ajsWvah2QaaK34JlAGA in range(




























                                                                     5






















                                                                                                                        ):
            self._VYtalybfeVgGQ9k2kie7X3aTF14HTw.append(




























                                                                         self._ZsOLHKPgavZBqXRgz4sOzzJqvDiW0n('bottomupresults' + str(




























                                                                             _bipEZxWY564ajsWvah2QaaK34JlAGA+1






















                                                                                                                            ) + '.txt')






















                                                                                                                        )
        self._OxQNBcPpucqfkrakDbgGalvPrP2YAB = dict(




























                                                                     






















                                                                                                                        )

    def _ZsOLHKPgavZBqXRgz4sOzzJqvDiW0n(




























                                                                 self, _i6AVkw2RRVJ0XES7k26caJm34iApnO






















                                                                                                                    ):
        _i6AVkw2RRVJ0XES7k26caJm34iApnO = _Y16pccsmJOAVZctSaX5KkAP1sGEAo1 + "/" + _i6AVkw2RRVJ0XES7k26caJm34iApnO
        try:
            _8EIm1jHuFPMJCxp1o0WXGVkp13ORha = open(




























                                                                         _i6AVkw2RRVJ0XES7k26caJm34iApnO, 'r').read(




























                                                                         






















                                                                                                                            ).splitlines(




























                                                                                                                                                                                     






















                                                                                                                            )[:-1]
        except FileNotFoundError:
            raise FileNotFoundError("Missing " + _i6AVkw2RRVJ0XES7k26caJm34iApnO






















                                                                                                                            )
    
        _hksGofNNJG1tRTwrWt59U56qakWygH = dict(




























                                                                     






















                                                                                                                        )
        
        for _U88KXjbsZUoit5kbqEHuUhEuXjfPXA in _8EIm1jHuFPMJCxp1o0WXGVkp13ORha:
            if 'children' not in _U88KXjbsZUoit5kbqEHuUhEuXjfPXA and 'parents' not in _U88KXjbsZUoit5kbqEHuUhEuXjfPXA:
                _VjVfaVvZi0JXJmfHg9DD4u5nOlo9FE = _U88KXjbsZUoit5kbqEHuUhEuXjfPXA.strip(




























                                                                             






















                                                                                                                                ).split(




























                                                                                                                                                                                         






















                                                                                                                                )[0]
                _IYLAs5Gxi9rkuJGWZ6rSEJtukBv6Er = _U88KXjbsZUoit5kbqEHuUhEuXjfPXA.strip(




























                                                                             






















                                                                                                                                ).split(




























                                                                                                                                                                                         






















                                                                                                                                )[1]
                if _IYLAs5Gxi9rkuJGWZ6rSEJtukBv6Er not in _hksGofNNJG1tRTwrWt59U56qakWygH:
                    _hksGofNNJG1tRTwrWt59U56qakWygH[_IYLAs5Gxi9rkuJGWZ6rSEJtukBv6Er] = [_VjVfaVvZi0JXJmfHg9DD4u5nOlo9FE]
                else:
                    _hksGofNNJG1tRTwrWt59U56qakWygH[_IYLAs5Gxi9rkuJGWZ6rSEJtukBv6Er].append(




























                                                                                 _VjVfaVvZi0JXJmfHg9DD4u5nOlo9FE






















                                                                                                                                    )
        return _hksGofNNJG1tRTwrWt59U56qakWygH
    def _28xTRqq0NEjMqRN8GVOxZiTfRiZ6yU(




























                                                                 self, _VjVfaVvZi0JXJmfHg9DD4u5nOlo9FE






















                                                                                                                    ):
        if _VjVfaVvZi0JXJmfHg9DD4u5nOlo9FE in self._OxQNBcPpucqfkrakDbgGalvPrP2YAB:
            return
        else:
            if _VjVfaVvZi0JXJmfHg9DD4u5nOlo9FE.count('*')-1 == len(




























                                                                         _VjVfaVvZi0JXJmfHg9DD4u5nOlo9FE.replace('*', '').replace('(', '').replace(')','')






















                                                                                                                            ):
                _vqQ6ryaWUhqLejVIF8hfWky4ugVt2G = _VjVfaVvZi0JXJmfHg9DD4u5nOlo9FE.replace('(','[').replace('*', '|').replace('|)|', ']*')
                self._OxQNBcPpucqfkrakDbgGalvPrP2YAB[_VjVfaVvZi0JXJmfHg9DD4u5nOlo9FE] = re.compile('^' + _vqQ6ryaWUhqLejVIF8hfWky4ugVt2G + '$')
            else:
                self._OxQNBcPpucqfkrakDbgGalvPrP2YAB[_VjVfaVvZi0JXJmfHg9DD4u5nOlo9FE] = re.compile('^' + _VjVfaVvZi0JXJmfHg9DD4u5nOlo9FE + '$')
 
    def _uuUf3SsiatrRrOERI7tRecv5BkyBf4(




























                                                                 self, _lTtHK5AYK7QM0L2emWu8kymH7upKEA






















                                                                                                                    ):
        _k3hJLcajoYNbAIIKCv5paIDzU8jfDn = {}
        for _KT3yFAJlB7mFlVKT39u2gqrj9zTaZ6 in _lTtHK5AYK7QM0L2emWu8kymH7upKEA:
            if _KT3yFAJlB7mFlVKT39u2gqrj9zTaZ6 not in _k3hJLcajoYNbAIIKCv5paIDzU8jfDn:
                _k3hJLcajoYNbAIIKCv5paIDzU8jfDn[_KT3yFAJlB7mFlVKT39u2gqrj9zTaZ6] = str(




























                                                                             chr(




























                                                                                 ord('A') + len(




























                                                                                     _k3hJLcajoYNbAIIKCv5paIDzU8jfDn






















                                                                                                                                )))
        return _k3hJLcajoYNbAIIKCv5paIDzU8jfDn


    def _BVgki98RR4T7sYaaGwbWwcinFv2QHP(




























                                                                 self, _B5mMRRKJGHhB3Q11zNeqFD44MbIDBi, _lTtHK5AYK7QM0L2emWu8kymH7upKEA






















                                                                                                                    ):
        _Da3lQ2HUpYrD2f9T4FsXknOvj2NeKh = ""
        for _KT3yFAJlB7mFlVKT39u2gqrj9zTaZ6 in _lTtHK5AYK7QM0L2emWu8kymH7upKEA:
            _Da3lQ2HUpYrD2f9T4FsXknOvj2NeKh += _B5mMRRKJGHhB3Q11zNeqFD44MbIDBi[_KT3yFAJlB7mFlVKT39u2gqrj9zTaZ6]
        return _Da3lQ2HUpYrD2f9T4FsXknOvj2NeKh


    def _A181tq8govY5kf0P0yooRcbXHY7wt2(




























                                                                 self, _B5mMRRKJGHhB3Q11zNeqFD44MbIDBi, _Da3lQ2HUpYrD2f9T4FsXknOvj2NeKh






















                                                                                                                    ):
        _Ip8JZ6UBgIY3iHGFg8yFVLIfcviK0e = {_1W4XXjok0ZKBKQ8Di4NMCotUx5afA0: _MZSiY560EwtOHbrJw8QJgDH0AIibTe for _MZSiY560EwtOHbrJw8QJgDH0AIibTe, _1W4XXjok0ZKBKQ8Di4NMCotUx5afA0 in _B5mMRRKJGHhB3Q11zNeqFD44MbIDBi.items(




























                                                                     






















                                                                                                                        )}
        _lTtHK5AYK7QM0L2emWu8kymH7upKEA = ""
        for _KT3yFAJlB7mFlVKT39u2gqrj9zTaZ6 in _Da3lQ2HUpYrD2f9T4FsXknOvj2NeKh:
            if _KT3yFAJlB7mFlVKT39u2gqrj9zTaZ6 in _Ip8JZ6UBgIY3iHGFg8yFVLIfcviK0e:
                _lTtHK5AYK7QM0L2emWu8kymH7upKEA += _Ip8JZ6UBgIY3iHGFg8yFVLIfcviK0e[_KT3yFAJlB7mFlVKT39u2gqrj9zTaZ6]
            else:
                _lTtHK5AYK7QM0L2emWu8kymH7upKEA += _KT3yFAJlB7mFlVKT39u2gqrj9zTaZ6
        return _lTtHK5AYK7QM0L2emWu8kymH7upKEA

    def _lN6zQTLhjYnDH5oK66ELVBYF9LNqFf(




























                                                                 self, _VjVfaVvZi0JXJmfHg9DD4u5nOlo9FE, _lTtHK5AYK7QM0L2emWu8kymH7upKEA






















                                                                                                                    ):
        self._28xTRqq0NEjMqRN8GVOxZiTfRiZ6yU(




























                                                                     _VjVfaVvZi0JXJmfHg9DD4u5nOlo9FE






















                                                                                                                        )
        if self._OxQNBcPpucqfkrakDbgGalvPrP2YAB[_VjVfaVvZi0JXJmfHg9DD4u5nOlo9FE].match(




























                                                                     _lTtHK5AYK7QM0L2emWu8kymH7upKEA






















                                                                                                                        ):
            return True
        else:
            return False

    def _Jgx9J3Wge7nmAq0BepL9ZaJVuXgC5w(




























                                                                 self, _VjVfaVvZi0JXJmfHg9DD4u5nOlo9FE






















                                                                                                                    ):
        if _VjVfaVvZi0JXJmfHg9DD4u5nOlo9FE[0] == '(':
            return _VjVfaVvZi0JXJmfHg9DD4u5nOlo9FE[1]
        else:
            return _VjVfaVvZi0JXJmfHg9DD4u5nOlo9FE[0]


    def _xku3WJgZTasN6AZ2karc5kXZXPuQqz(




























                                                                 self, _hksGofNNJG1tRTwrWt59U56qakWygH, _hmYAnUnlNc36Vh4PJb5KcZ7zsekNJD






















                                                                                                                    ):
        _cDFkYt7ZVGaAASPhE5N9YksaRJLgAh = dict(




























                                                                     






















                                                                                                                        )
        for _IYLAs5Gxi9rkuJGWZ6rSEJtukBv6Er in _hksGofNNJG1tRTwrWt59U56qakWygH.copy(




























                                                                     






















                                                                                                                        ):
            _cDFkYt7ZVGaAASPhE5N9YksaRJLgAh[_IYLAs5Gxi9rkuJGWZ6rSEJtukBv6Er] = []
            for _VjVfaVvZi0JXJmfHg9DD4u5nOlo9FE in _hksGofNNJG1tRTwrWt59U56qakWygH.copy(




























                                                                         






















                                                                                                                            )[_IYLAs5Gxi9rkuJGWZ6rSEJtukBv6Er]:
                if self._Jgx9J3Wge7nmAq0BepL9ZaJVuXgC5w(




























                                                                             _VjVfaVvZi0JXJmfHg9DD4u5nOlo9FE






















                                                                                                                                ) != _hmYAnUnlNc36Vh4PJb5KcZ7zsekNJD:
                    _cDFkYt7ZVGaAASPhE5N9YksaRJLgAh[_IYLAs5Gxi9rkuJGWZ6rSEJtukBv6Er].append(




























                                                                                 _VjVfaVvZi0JXJmfHg9DD4u5nOlo9FE






















                                                                                                                                    )
        for _IYLAs5Gxi9rkuJGWZ6rSEJtukBv6Er in _cDFkYt7ZVGaAASPhE5N9YksaRJLgAh:
            _wh5ol28lLzME9TuuA3L5plpLbRmKHg = set(




























                                                                         _hksGofNNJG1tRTwrWt59U56qakWygH[_IYLAs5Gxi9rkuJGWZ6rSEJtukBv6Er]






















                                                                                                                            )
            for _VjVfaVvZi0JXJmfHg9DD4u5nOlo9FE in _cDFkYt7ZVGaAASPhE5N9YksaRJLgAh[_IYLAs5Gxi9rkuJGWZ6rSEJtukBv6Er]:
                _wh5ol28lLzME9TuuA3L5plpLbRmKHg.remove(




























                                                                             _VjVfaVvZi0JXJmfHg9DD4u5nOlo9FE






















                                                                                                                                )
            _hksGofNNJG1tRTwrWt59U56qakWygH[_IYLAs5Gxi9rkuJGWZ6rSEJtukBv6Er] = list(




























                                                                         _wh5ol28lLzME9TuuA3L5plpLbRmKHg






















                                                                                                                            )


    def _pVIu62J6r9I5jCbEpFTEGQi8Kl0TY6(




























                                                                 self, _lTtHK5AYK7QM0L2emWu8kymH7upKEA






















                                                                                                                    ):
        return len(




























                                                                     set(




























                                                                         _lTtHK5AYK7QM0L2emWu8kymH7upKEA.replace("*", "").replace("(", "").replace(")", "")






















                                                                                                                        ))

    def _rVh3XBS0utwkf6TDnvBa5Gy0ccO8Gz(




























                                                                 self, _oENrKWwXPjlRWBXB8U97G4wNw3mEls






















                                                                                                                    ):
        _pCEToDFxn2yRDYqyL5pAKiCjmOOxC0 = len(




























                                                                     min(




























                                                                         _oENrKWwXPjlRWBXB8U97G4wNw3mEls, key=len






















                                                                                                                        ))
        return [_VjVfaVvZi0JXJmfHg9DD4u5nOlo9FE for _VjVfaVvZi0JXJmfHg9DD4u5nOlo9FE in _oENrKWwXPjlRWBXB8U97G4wNw3mEls if len(




























                                                                     _VjVfaVvZi0JXJmfHg9DD4u5nOlo9FE






















                                                                                                                        )==_pCEToDFxn2yRDYqyL5pAKiCjmOOxC0]

    def _Dlm05jKAt4CNnSoiuGRCcKOgDOz4yt(




























                                                                 self, _lTtHK5AYK7QM0L2emWu8kymH7upKEA






















                                                                                                                    ):
        _k3hJLcajoYNbAIIKCv5paIDzU8jfDn = self._uuUf3SsiatrRrOERI7tRecv5BkyBf4(




























                                                                     _lTtHK5AYK7QM0L2emWu8kymH7upKEA






















                                                                                                                        )
        _Da3lQ2HUpYrD2f9T4FsXknOvj2NeKh = self._BVgki98RR4T7sYaaGwbWwcinFv2QHP(




























                                                                     _k3hJLcajoYNbAIIKCv5paIDzU8jfDn, _lTtHK5AYK7QM0L2emWu8kymH7upKEA






















                                                                                                                        )

        _hksGofNNJG1tRTwrWt59U56qakWygH = self._VYtalybfeVgGQ9k2kie7X3aTF14HTw[len(




























                                                                     _k3hJLcajoYNbAIIKCv5paIDzU8jfDn






















                                                                                                                        )-1].copy(




























                                                                                                                                                                                 






















                                                                                                                        )

        self._xku3WJgZTasN6AZ2karc5kXZXPuQqz(




























                                                                     _hksGofNNJG1tRTwrWt59U56qakWygH, _Da3lQ2HUpYrD2f9T4FsXknOvj2NeKh[0]






















                                                                                                                        )
        
        _5c8anPVkPyMycCQl0WuBi6iGy5FrkC = []
        _SMnMsLQzXx2jQ2X2jJ8nwC0Me3S79r = [int(




























                                                                     _IYLAs5Gxi9rkuJGWZ6rSEJtukBv6Er






















                                                                                                                        ) for _IYLAs5Gxi9rkuJGWZ6rSEJtukBv6Er in _hksGofNNJG1tRTwrWt59U56qakWygH.keys(




























                                                                                                                                                                                 






















                                                                                                                        )]
        _IYLAs5Gxi9rkuJGWZ6rSEJtukBv6Er = max(




























                                                                     _SMnMsLQzXx2jQ2X2jJ8nwC0Me3S79r






















                                                                                                                        )

        while _IYLAs5Gxi9rkuJGWZ6rSEJtukBv6Er >= 0:
            for _VjVfaVvZi0JXJmfHg9DD4u5nOlo9FE in _hksGofNNJG1tRTwrWt59U56qakWygH[str(




























                                                                         _IYLAs5Gxi9rkuJGWZ6rSEJtukBv6Er






















                                                                                                                            )]:
                if self._lN6zQTLhjYnDH5oK66ELVBYF9LNqFf(




























                                                                             _VjVfaVvZi0JXJmfHg9DD4u5nOlo9FE, _Da3lQ2HUpYrD2f9T4FsXknOvj2NeKh






















                                                                                                                                ):
                    _5c8anPVkPyMycCQl0WuBi6iGy5FrkC.append(




























                                                                                 _VjVfaVvZi0JXJmfHg9DD4u5nOlo9FE






















                                                                                                                                    )
            if _5c8anPVkPyMycCQl0WuBi6iGy5FrkC:
                break
            else:
                _IYLAs5Gxi9rkuJGWZ6rSEJtukBv6Er -= 1

        _Yf5U7qxC4UyXfKbRl2LcVPvJV1Qy9W = self._rVh3XBS0utwkf6TDnvBa5Gy0ccO8Gz(




























                                                                     _5c8anPVkPyMycCQl0WuBi6iGy5FrkC






















                                                                                                                        )

        _MgZ8qkJpfeOYG2xSTooLvDoWUc2ETF = []
        for _XiSVPCmuPPXrjSXzqViovjwFXaloUi in _Yf5U7qxC4UyXfKbRl2LcVPvJV1Qy9W:
            _o91f3yArrgZKWwaGgpmRLaBl1hpusI = self._A181tq8govY5kf0P0yooRcbXHY7wt2(




























                                                                         _k3hJLcajoYNbAIIKCv5paIDzU8jfDn, _XiSVPCmuPPXrjSXzqViovjwFXaloUi






















                                                                                                                            )
            _MgZ8qkJpfeOYG2xSTooLvDoWUc2ETF.append(




























                                                                         _o91f3yArrgZKWwaGgpmRLaBl1hpusI






















                                                                                                                            )

        return {_VjVfaVvZi0JXJmfHg9DD4u5nOlo9FE : str(




























                                                                     _IYLAs5Gxi9rkuJGWZ6rSEJtukBv6Er






















                                                                                                                        ) for _VjVfaVvZi0JXJmfHg9DD4u5nOlo9FE in _MgZ8qkJpfeOYG2xSTooLvDoWUc2ETF}  

